{% extends 'base.html' %}

{% block title %}Archived Services · Dreambook Salon{% endblock %}

{% block content %}
  <div class="container-custom py-12">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-12 gap-4">
      <div>
        <h1 class="text-4xl font-bold text-gradient mb-2">Archived Services</h1>
        <p class="text-light-muted">View and restore archived services that are hidden from customers</p>
      </div>
      <a href="{% url 'services:list' %}" class="btn btn-ghost">
        ← Back to All Services
      </a>
    </div>

    {% if services %}
      <!-- Services Table -->
      <div class="card overflow-hidden">
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead class="bg-light-elevated border-b border-light-border">
              <tr>
                <th class="text-left py-4 px-6 font-semibold text-light-text">Service</th>
                <th class="text-center py-4 px-4 font-semibold text-light-muted">Price</th>
                <th class="text-center py-4 px-4 font-semibold text-light-muted">Duration</th>
                <th class="text-center py-4 px-4 font-semibold text-light-muted">Archived On</th>
                <th class="text-right py-4 px-6 font-semibold text-light-muted">Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for service in services %}
                <tr class="border-b border-light-border hover:bg-light-elevated transition-colors">
                  <td class="py-4 px-6">
                    <div class="flex items-center gap-3">
                      {% if service.image %}
                        <img src="{{ service.image.url }}" alt="{{ service.name }}" class="w-12 h-12 rounded object-cover">
                      {% else %}
                        <div class="w-12 h-12 rounded bg-light-border flex items-center justify-center text-light-muted">
                          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                          </svg>
                        </div>
                      {% endif %}
                      <div>
                        <div class="font-semibold text-light-text">{{ service.name }}</div>
                        {% if service.description %}
                          <div class="text-sm text-light-muted line-clamp-1">{{ service.description|truncatewords:10 }}</div>
                        {% endif %}
                      </div>
                    </div>
                  </td>
                  <td class="text-center py-4 px-4 font-semibold text-primary-600">₱{{ service.price|floatformat:2 }}</td>
                  <td class="text-center py-4 px-4 text-light-text">{{ service.duration_minutes }} min</td>
                  <td class="text-center py-4 px-4 text-light-muted text-sm">
                    {{ service.updated_at|date:"M d, Y" }}
                  </td>
                  <td class="text-right py-4 px-6">
                    <div class="flex justify-end gap-2">
                      <a href="{% url 'services:detail' service.pk %}" class="btn btn-ghost btn-sm">
                        View
                      </a>
                      <form method="post" action="{% url 'services:unarchive' service.pk %}" class="inline">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-primary btn-sm" onclick="return confirm('Restore this service? It will be visible to customers again.')">
                          <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                          </svg>
                          Restore
                        </button>
                      </form>
                    </div>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

      <!-- Pagination -->
      {% if is_paginated %}
        <div class="flex justify-center mt-8">
          <div class="flex gap-2">
            {% if page_obj.has_previous %}
              <a href="?page=1" class="btn btn-ghost btn-sm">First</a>
              <a href="?page={{ page_obj.previous_page_number }}" class="btn btn-ghost btn-sm">Previous</a>
            {% endif %}

            <span class="px-4 py-2 text-sm text-light-text">
              Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
            </span>

            {% if page_obj.has_next %}
              <a href="?page={{ page_obj.next_page_number }}" class="btn btn-ghost btn-sm">Next</a>
              <a href="?page={{ page_obj.paginator.num_pages }}" class="btn btn-ghost btn-sm">Last</a>
            {% endif %}
          </div>
        </div>
      {% endif %}
    {% else %}
      <!-- Empty State -->
      <div class="card p-12 text-center">
        <div class="max-w-md mx-auto">
          <svg class="w-20 h-20 mx-auto mb-4 text-light-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"></path>
          </svg>
          <h3 class="text-xl font-semibold text-light-text mb-2">No Archived Services</h3>
          <p class="text-light-muted mb-6">
            You don't have any archived services yet. Archived services are hidden from customers but can be restored at any time.
          </p>
          <a href="{% url 'services:list' %}" class="btn btn-primary">
            View All Services
          </a>
        </div>
      </div>
    {% endif %}
  </div>
{% endblock %}
