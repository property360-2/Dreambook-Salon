{% extends 'base.html' %}

{% block title %}Make Payment ¬∑ Dreambook Salon{% endblock title %}

{% block content %}
  <div class="container-custom py-12">
    <div class="max-w-4xl mx-auto">
      <!-- Header -->
      <div class="mb-8">
        <h1 class="text-4xl font-bold text-gradient mb-2">Make Payment</h1>
        <p class="text-light-muted">Complete your payment for this appointment</p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Main Content -->
        <div class="lg:col-span-2">
          <!-- Appointment Summary -->
          <div class="card p-6 mb-6">
            <h2 class="text-2xl font-bold text-light-text mb-4">Appointment Summary</h2>
            <div class="space-y-3">
              <div class="flex items-center justify-between p-4 bg-light-elevated rounded-lg border border-light-border">
                <span class="text-light-muted">Service</span>
                <span class="text-light-text font-semibold">{{ appointment.service.name }}</span>
              </div>
              <div class="flex items-center justify-between p-4 bg-light-elevated rounded-lg border border-light-border">
                <span class="text-light-muted">Date & Time</span>
                <span class="text-light-text font-semibold">{{ appointment.start_at|date:"F d, Y g:i A" }}</span>
              </div>
              <div class="flex items-center justify-between p-4 bg-light-elevated rounded-lg border border-light-border">
                <span class="text-light-muted">Duration</span>
                <span class="text-light-text font-semibold">{{ appointment.service.duration_minutes }} minutes</span>
              </div>
              <div class="flex items-center justify-between p-4 bg-primary-500/10 rounded-lg border border-primary-500/20">
                <span class="text-primary-600 font-semibold">Amount to Pay</span>
                <span class="text-gradient font-bold text-3xl">‚Ç±{{ appointment.service.price }}</span>
              </div>
            </div>
          </div>

          <!-- Payment Form -->
          <form method="post" class="card p-6">
            {% csrf_token %}

            {% if form.non_field_errors %}
              <div class="alert alert-error mb-6">
                {% for error in form.non_field_errors %}
                  <p>{{ error }}</p>
                {% endfor %}
              </div>
            {% endif %}

            <!-- Form Fields -->
            {% if form %}
              <div class="space-y-4 mb-6">
                {% for field in form %}
                  {% include 'components/molecules/form_field.html' with field=field %}
                {% endfor %}
              </div>
            {% endif %}

            <!-- Payment Methods -->
            <div class="mb-6">
              <h3 class="text-xl font-bold text-light-text mb-4">Select Payment Method</h3>
              <div class="space-y-3">
                <label class="flex items-center p-4 bg-light-elevated rounded-xl border border-light-border hover:border-primary-500/50 cursor-pointer transition-all">
                  <input type="radio" name="method" value="GCASH" required class="mr-4 w-5 h-5 text-primary-500 border-light-border focus:ring-primary-500 focus:ring-2">
                  <div class="flex-1">
                    <span class="text-light-text font-semibold block mb-1">GCash</span>
                    <span class="text-light-muted text-sm">Pay via GCash mobile wallet</span>
                  </div>
                  <span class="text-2xl">üí∞</span>
                </label>
                <label class="flex items-center p-4 bg-light-elevated rounded-xl border border-light-border hover:border-primary-500/50 cursor-pointer transition-all">
                  <input type="radio" name="method" value="PAYMAYA" required class="mr-4 w-5 h-5 text-primary-500 border-light-border focus:ring-primary-500 focus:ring-2">
                  <div class="flex-1">
                    <span class="text-light-text font-semibold block mb-1">PayMaya</span>
                    <span class="text-light-muted text-sm">Pay via PayMaya mobile wallet</span>
                  </div>
                  <span class="text-2xl">üí≥</span>
                </label>
                <label class="flex items-center p-4 bg-light-elevated rounded-xl border border-light-border hover:border-primary-500/50 cursor-pointer transition-all">
                  <input type="radio" name="method" value="ONSITE" required class="mr-4 w-5 h-5 text-primary-500 border-light-border focus:ring-primary-500 focus:ring-2">
                  <div class="flex-1">
                    <span class="text-light-text font-semibold block mb-1">Pay at Salon</span>
                    <span class="text-light-muted text-sm">Pay cash at the salon</span>
                  </div>
                  <span class="text-2xl">üè™</span>
                </label>
              </div>
            </div>

            <!-- Actions -->
            <div class="flex flex-col sm:flex-row gap-3">
              <button type="submit" class="btn btn-primary flex-1">
                Complete Payment
              </button>
              <a href="{% url 'appointments:detail' appointment.id %}" class="btn btn-ghost flex-1">
                Cancel
              </a>
            </div>
          </form>
        </div>

        <!-- Sidebar Info -->
        <div class="lg:col-span-1">
          <div class="card p-6 sticky top-24">
            <h3 class="text-lg font-bold text-light-text mb-4">Payment Information</h3>
            <div class="space-y-3 text-sm text-light-muted">
              <div class="flex items-start gap-2">
                <span class="text-emerald-400">‚úì</span>
                <p>All payments are processed securely</p>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-emerald-400">‚úì</span>
                <p>You will receive a confirmation email after payment</p>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-emerald-400">‚úì</span>
                <p>For online payments, you will be redirected to the payment provider</p>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-emerald-400">‚úì</span>
                <p>For onsite payments, please pay at the salon before your appointment</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock content %}
