{% extends 'base.html' %}

{% block title %}Confirm Action - User Management - Dreambook Salon{% endblock %}

{% block content %}
<div class="container-custom py-12">
  <div class="max-w-2xl mx-auto">
    <!-- Header -->
    <div class="mb-8 animate-slide-up text-center">
      <div class="mb-6">
        {% if action_type == 'deactivate' %}
          <div class="w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center">
            <span class="text-3xl">‚è∏Ô∏è</span>
          </div>
          <h1 class="text-4xl font-bold text-gradient mb-2">Deactivate User</h1>
          <p class="text-light-muted">This action will disable the user's account</p>
        {% elif action_type == 'reactivate' %}
          <div class="w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full flex items-center justify-center">
            <span class="text-3xl">‚úÖ</span>
          </div>
          <h1 class="text-4xl font-bold text-gradient mb-2">Reactivate User</h1>
          <p class="text-light-muted">This action will re-enable the user's account</p>
        {% elif action_type == 'reset_password' %}
          <div class="w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center">
            <span class="text-3xl">üîê</span>
          </div>
          <h1 class="text-4xl font-bold text-gradient mb-2">Reset Password</h1>
          <p class="text-light-muted">Send a password reset email to the user</p>
        {% endif %}
      </div>
    </div>

    <!-- Confirmation Card -->
    <div class="card p-8">
      <!-- User Details -->
      <div class="mb-8 pb-8 border-b border-light-border">
        <h2 class="text-lg font-bold text-light-text mb-4">User Account</h2>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="text-xs font-semibold text-light-muted uppercase tracking-wider mb-1 block">Email</label>
            <p class="text-light-text font-mono">{{ user.email }}</p>
          </div>
          <div>
            <label class="text-xs font-semibold text-light-muted uppercase tracking-wider mb-1 block">Name</label>
            <p class="text-light-text">{{ user.get_full_name|default:"(No name)" }}</p>
          </div>
        </div>
      </div>

      <!-- Action Details -->
      <div class="mb-8">
        <h2 class="text-lg font-bold text-light-text mb-4">Confirm Action</h2>

        {% if action_type == 'deactivate' %}
          <div class="p-4 bg-red-50 border border-red-200 rounded mb-6">
            <h3 class="font-semibold text-red-700 mb-2">‚è∏Ô∏è Deactivate User Account</h3>
            <p class="text-sm text-red-600 mb-3">
              This will immediately disable this user's account. They will not be able to log in or access the system.
            </p>
            <ul class="text-sm text-red-600 space-y-1 ml-4 list-disc">
              <li>The user's data will be preserved</li>
              <li>You can reactivate the account later if needed</li>
              <li>This action will be logged in the audit trail</li>
            </ul>
          </div>

          <p class="text-sm text-light-muted mb-6">
            Are you sure you want to deactivate <strong>{{ user.email }}</strong>?
          </p>

        {% elif action_type == 'reactivate' %}
          <div class="p-4 bg-green-50 border border-green-200 rounded mb-6">
            <h3 class="font-semibold text-green-700 mb-2">‚úÖ Reactivate User Account</h3>
            <p class="text-sm text-green-600 mb-3">
              This will re-enable this user's account. They will be able to log in and access the system again.
            </p>
            <ul class="text-sm text-green-600 space-y-1 ml-4 list-disc">
              <li>All user data will remain intact</li>
              <li>The user's role and permissions will be restored</li>
              <li>This action will be logged in the audit trail</li>
            </ul>
          </div>

          <p class="text-sm text-light-muted mb-6">
            Are you sure you want to reactivate <strong>{{ user.email }}</strong>?
          </p>

        {% elif action_type == 'reset_password' %}
          <div class="p-4 bg-blue-50 border border-blue-200 rounded mb-6">
            <h3 class="font-semibold text-blue-700 mb-2">üîê Send Password Reset Email</h3>
            <p class="text-sm text-blue-600 mb-3">
              A password reset link will be sent to the user's email address. They can use this link to create a new password.
            </p>
            <ul class="text-sm text-blue-600 space-y-1 ml-4 list-disc">
              <li>Email will be sent to: <strong>{{ user.email }}</strong></li>
              <li>Reset link will expire in 24 hours</li>
              <li>User can request another reset if needed</li>
              <li>This action will be logged in the audit trail</li>
            </ul>
          </div>

          <p class="text-sm text-light-muted mb-6">
            Send a password reset email to <strong>{{ user.email }}</strong>?
          </p>
        {% endif %}
      </div>

      <!-- Action Buttons -->
      <div class="pt-6 border-t border-light-border flex gap-3 justify-end">
        <a href="{% url 'core:user_detail' user.id %}" class="btn btn-ghost">
          ‚Üê Cancel
        </a>

        <form method="post" class="inline">
          {% csrf_token %}
          {% if action_type == 'deactivate' %}
            <button type="submit" class="btn btn-primary bg-red-600 hover:bg-red-700 text-white">
              ‚è∏Ô∏è Deactivate User
            </button>
          {% elif action_type == 'reactivate' %}
            <button type="submit" class="btn btn-primary bg-green-600 hover:bg-green-700 text-white">
              ‚úÖ Reactivate User
            </button>
          {% elif action_type == 'reset_password' %}
            <button type="submit" class="btn btn-primary bg-blue-600 hover:bg-blue-700 text-white">
              üîê Send Reset Email
            </button>
          {% endif %}
        </form>
      </div>
    </div>

    <!-- Info Box -->
    <div class="mt-6 p-4 bg-light-bg border border-light-border rounded">
      <p class="text-xs text-light-muted">
        <strong>üí° Tip:</strong> All user management actions are automatically logged in the audit trail for compliance and security purposes.
      </p>
    </div>
  </div>
</div>
{% endblock %}
