{% extends 'base.html' %}

{% block title %}
  {% if is_edit %}Edit{% else %}Add{% endif %} Slot Limit · Dreambook Salon
{% endblock title %}

{% block content %}
  <div class="container-custom py-12">
    <div class="max-w-2xl mx-auto">
      <!-- Header -->
      <div class="mb-8">
        <h1 class="text-4xl font-bold text-gradient mb-2">{{ form_title }}</h1>
        <p class="text-light-muted">{% if is_edit %}Modify the slot limit settings{% else %}Create a new slot limit to control availability{% endif %}</p>
      </div>

      <!-- Form Card -->
      <div class="card p-8">
        <form method="post" class="space-y-6 form-with-loading">
          {% csrf_token %}

          <!-- Date -->
          <div>
            <label for="id_date" class="block text-sm font-semibold text-light-text mb-2">Date *</label>
            <input type="date" id="id_date" name="date"
                   value="{% if slot_limit %}{{ slot_limit.date|date:'Y-m-d' }}{% elif form.initial.date %}{{ form.initial.date }}{% endif %}"
                   required class="input w-full">
            <p class="text-light-muted text-sm mt-1">The date this slot limit applies to</p>
          </div>

          <!-- Time Start -->
          <div>
            <label for="id_time_start" class="block text-sm font-semibold text-light-text mb-2">Start Time *</label>
            <input type="time" id="id_time_start" name="time_start"
                   value="{% if slot_limit %}{{ slot_limit.time_start }}{% elif form.initial.time_start %}{{ form.initial.time_start }}{% endif %}"
                   required class="input w-full">
            <p class="text-light-muted text-sm mt-1">When the limit begins</p>
          </div>

          <!-- Time End -->
          <div>
            <label for="id_time_end" class="block text-sm font-semibold text-light-text mb-2">End Time *</label>
            <input type="time" id="id_time_end" name="time_end"
                   value="{% if slot_limit %}{{ slot_limit.time_end }}{% elif form.initial.time_end %}{{ form.initial.time_end }}{% endif %}"
                   required class="input w-full">
            <p class="text-light-muted text-sm mt-1">When the limit ends</p>
          </div>

          <!-- Max Slots -->
          <div>
            <label for="id_max_slots" class="block text-sm font-semibold text-light-text mb-2">Max Concurrent Slots *</label>
            <input type="number" id="id_max_slots" name="max_slots" min="1"
                   value="{% if slot_limit %}{{ slot_limit.max_slots }}{% else %}1{% endif %}"
                   required class="input w-full">
            <p class="text-light-muted text-sm mt-1">Maximum number of appointments allowed at the same time</p>
          </div>

          <!-- Reason -->
          <div>
            <label for="id_reason" class="block text-sm font-semibold text-light-text mb-2">Reason (Optional)</label>
            <input type="text" id="id_reason" name="reason" maxlength="255"
                   value="{% if slot_limit %}{{ slot_limit.reason }}{% endif %}"
                   placeholder="e.g., Staff meeting, Maintenance, Staff absent"
                   class="input w-full">
            <p class="text-light-muted text-sm mt-1">Document why this limit exists</p>
          </div>

          <!-- Info Box -->
          <div class="card bg-blue-500/10 border border-blue-500/20 p-4 rounded-lg">
            <p class="text-blue-300 text-sm">
              <strong>Example:</strong> If you set max slots to 1 for 2:00 PM - 2:30 PM on Dec 25, only one appointment can be booked at that time, regardless of the global setting.
            </p>
          </div>

          <!-- Actions -->
          <div class="flex gap-3 pt-4">
            <button type="submit" class="btn btn-primary flex-1">
              {% if is_edit %}Update Slot Limit{% else %}Create Slot Limit{% endif %}
            </button>
            <a href="{% url 'appointments:slotlimit_list' %}" class="btn btn-ghost flex-1">
              Cancel
            </a>
          </div>
        </form>
      </div>

      <!-- Back Link -->
      <div class="mt-8">
        <a href="{% url 'appointments:slotlimit_list' %}" class="text-primary-600 hover:text-primary-300 transition-colors">
          ← Back to Slot Limits
        </a>
      </div>
    </div>
  </div>
{% endblock content %}
